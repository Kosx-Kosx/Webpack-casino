import { InjectionToken, Inject, Injectable, Directive, ElementRef, Input, NgModule, Renderer2 } from '@angular/core';
import { BehaviorSubject, ReplaySubject } from 'rxjs';
import { __spread, __assign, __values } from 'tslib';
import { filter, delay, map } from 'rxjs/operators';
import { Location } from '@angular/common';
import { NavigationEnd, Router } from '@angular/router';

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes} checked by tsc
 */
var DefaultConfig = /** @class */ (function () {
    function DefaultConfig() {
        this.pageTracking = {
            autoTrackVirtualPages: true,
            basePath: '',
            excludedRoutes: [],
            clearIds: false,
            clearHash: false,
            clearQueryParams: false,
            idsRegExp: /^\d+$|^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/,
        };
        this.developerMode = false;
        this.ga = {};
        this.appInsights = {};
        this.gtm = {};
    }
    return DefaultConfig;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes} checked by tsc
 */
var /** @type {?} */ ANGULARTICS2_TOKEN = new InjectionToken('ANGULARTICS2');

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes} checked by tsc
 */
var RouterlessTracking = /** @class */ (function () {
    function RouterlessTracking() {
    }
    /**
     * @param {?} settings
     * @return {?}
     */
    RouterlessTracking.prototype.trackLocation = /**
     * @param {?} settings
     * @return {?}
     */
    function (settings) {
        return new BehaviorSubject({ url: '/' });
    };
    /**
     * @param {?} url
     * @return {?}
     */
    RouterlessTracking.prototype.prepareExternalUrl = /**
     * @param {?} url
     * @return {?}
     */
    function (url) {
        return url;
    };
    return RouterlessTracking;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes} checked by tsc
 */
var Angulartics2 = /** @class */ (function () {
    function Angulartics2(tracker, setup) {
        var _this = this;
        this.tracker = tracker;
        this.pageTrack = new ReplaySubject(10);
        this.eventTrack = new ReplaySubject(10);
        this.exceptionTrack = new ReplaySubject(10);
        this.setAlias = new ReplaySubject(10);
        this.setUsername = new ReplaySubject(10);
        this.setUserProperties = new ReplaySubject(10);
        this.setUserPropertiesOnce = new ReplaySubject(10);
        this.setSuperProperties = new ReplaySubject(10);
        this.setSuperPropertiesOnce = new ReplaySubject(10);
        this.userTimings = new ReplaySubject(10);
        var /** @type {?} */ defaultConfig = new DefaultConfig();
        this.settings = __assign({}, defaultConfig, setup.settings);
        this.settings.pageTracking = __assign({}, defaultConfig.pageTracking, setup.settings.pageTracking);
        this.tracker
            .trackLocation(this.settings)
            .subscribe(function (event) {
            return _this.trackUrlChange(event.url);
        });
    }
    /** filters all events when developer mode is true */
    /**
     * filters all events when developer mode is true
     * @template T
     * @return {?}
     */
    Angulartics2.prototype.filterDeveloperMode = /**
     * filters all events when developer mode is true
     * @template T
     * @return {?}
     */
    function () {
        var _this = this;
        return filter(function (value, index) { return !_this.settings.developerMode; });
    };
    /**
     * @param {?} url
     * @return {?}
     */
    Angulartics2.prototype.trackUrlChange = /**
     * @param {?} url
     * @return {?}
     */
    function (url) {
        if (this.settings.pageTracking.autoTrackVirtualPages && !this.matchesExcludedRoute(url)) {
            var /** @type {?} */ clearedUrl = this.clearUrl(url);
            var /** @type {?} */ path = void 0;
            if (this.settings.pageTracking.basePath.length) {
                path = this.settings.pageTracking.basePath + clearedUrl;
            }
            else {
                path = this.tracker.prepareExternalUrl(clearedUrl);
            }
            this.pageTrack.next({ path: path });
        }
    };
    /**
     * Use string literals or regular expressions to exclude routes
     * from automatic pageview tracking.
     *
     * @param url location
     */
    /**
     * Use string literals or regular expressions to exclude routes
     * from automatic pageview tracking.
     *
     * @param {?} url location
     * @return {?}
     */
    Angulartics2.prototype.matchesExcludedRoute = /**
     * Use string literals or regular expressions to exclude routes
     * from automatic pageview tracking.
     *
     * @param {?} url location
     * @return {?}
     */
    function (url) {
        try {
            for (var _a = __values(this.settings.pageTracking.excludedRoutes), _b = _a.next(); !_b.done; _b = _a.next()) {
                var excludedRoute = _b.value;
                var /** @type {?} */ matchesRegex = excludedRoute instanceof RegExp && excludedRoute.test(url);
                if (matchesRegex || url.indexOf(/** @type {?} */ (excludedRoute)) !== -1) {
                    return true;
                }
            }
        }
        catch (e_1_1) { e_1 = { error: e_1_1 }; }
        finally {
            try {
                if (_b && !_b.done && (_c = _a.return)) _c.call(_a);
            }
            finally { if (e_1) throw e_1.error; }
        }
        return false;
        var e_1, _c;
    };
    /**
     * Removes id's from tracked route.
     *  EX: `/project/12981/feature` becomes `/project/feature`
     *
     * @param url current page path
     */
    /**
     * Removes id's from tracked route.
     *  EX: `/project/12981/feature` becomes `/project/feature`
     *
     * @param {?} url current page path
     * @return {?}
     */
    Angulartics2.prototype.clearUrl = /**
     * Removes id's from tracked route.
     *  EX: `/project/12981/feature` becomes `/project/feature`
     *
     * @param {?} url current page path
     * @return {?}
     */
    function (url) {
        var _this = this;
        if (this.settings.pageTracking.clearIds || this.settings.pageTracking.clearQueryParams ||
            this.settings.pageTracking.clearHash) {
            return url
                .split('/')
                .map(function (part) { return _this.settings.pageTracking.clearQueryParams ? part.split('?')[0] : part; })
                .map(function (part) { return _this.settings.pageTracking.clearHash ? part.split('#')[0] : part; })
                .filter(function (part) { return !_this.settings.pageTracking.clearIds || !part.match(_this.settings.pageTracking.idsRegExp); })
                .join('/');
        }
        return url;
    };
    Angulartics2.decorators = [
        { type: Injectable }
    ];
    /** @nocollapse */
    Angulartics2.ctorParameters = function () { return [
        { type: RouterlessTracking },
        { type: undefined, decorators: [{ type: Inject, args: [ANGULARTICS2_TOKEN,] }] }
    ]; };
    return Angulartics2;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes} checked by tsc
 */
/**
 * Track Route changes for applications using Angular's
 * default router
 *
 * @link https://angular.io/api/router/Router
 */
var AngularRouterTracking = /** @class */ (function () {
    function AngularRouterTracking(router, location) {
        this.router = router;
        this.location = location;
    }
    /**
     * @param {?} settings
     * @return {?}
     */
    AngularRouterTracking.prototype.trackLocation = /**
     * @param {?} settings
     * @return {?}
     */
    function (settings) {
        return this.router.events.pipe(filter(function (e) { return e instanceof NavigationEnd; }), filter(function () { return !settings.developerMode; }), map(function (e) {
            return { url: e.urlAfterRedirects };
        }), delay(0));
    };
    /**
     * @param {?} url
     * @return {?}
     */
    AngularRouterTracking.prototype.prepareExternalUrl = /**
     * @param {?} url
     * @return {?}
     */
    function (url) {
        return this.location.prepareExternalUrl(url);
    };
    AngularRouterTracking.decorators = [
        { type: Injectable }
    ];
    /** @nocollapse */
    AngularRouterTracking.ctorParameters = function () { return [
        { type: Router },
        { type: Location }
    ]; };
    return AngularRouterTracking;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes} checked by tsc
 */
var Angulartics2On = /** @class */ (function () {
    function Angulartics2On(elRef, angulartics2, renderer) {
        this.elRef = elRef;
        this.angulartics2 = angulartics2;
        this.renderer = renderer;
        this.angularticsProperties = {};
    }
    /**
     * @return {?}
     */
    Angulartics2On.prototype.ngAfterContentInit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this.renderer.listen(this.elRef.nativeElement, this.angulartics2On || 'click', function (event) { return _this.eventTrack(event); });
    };
    /**
     * @param {?} event
     * @return {?}
     */
    Angulartics2On.prototype.eventTrack = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        var /** @type {?} */ action = this.angularticsAction; // || this.inferEventName();
        var /** @type {?} */ properties = __assign({}, this.angularticsProperties, { eventType: event.type });
        if (this.angularticsCategory) {
            properties.category = this.angularticsCategory;
        }
        if (this.angularticsLabel) {
            properties.label = this.angularticsLabel;
        }
        if (this.angularticsValue) {
            properties.value = this.angularticsValue;
        }
        this.angulartics2.eventTrack.next({
            action: action,
            properties: properties,
        });
    };
    Angulartics2On.decorators = [
        { type: Injectable },
        { type: Directive, args: [{ selector: '[angulartics2On]' },] }
    ];
    /** @nocollapse */
    Angulartics2On.ctorParameters = function () { return [
        { type: ElementRef },
        { type: Angulartics2 },
        { type: Renderer2 }
    ]; };
    Angulartics2On.propDecorators = {
        angulartics2On: [{ type: Input, args: ['angulartics2On',] }],
        angularticsAction: [{ type: Input }],
        angularticsCategory: [{ type: Input }],
        angularticsLabel: [{ type: Input }],
        angularticsValue: [{ type: Input }],
        angularticsProperties: [{ type: Input }]
    };
    return Angulartics2On;
}());
var Angulartics2OnModule = /** @class */ (function () {
    function Angulartics2OnModule() {
    }
    Angulartics2OnModule.decorators = [
        { type: NgModule, args: [{
                    declarations: [Angulartics2On],
                    exports: [Angulartics2On],
                },] }
    ];
    return Angulartics2OnModule;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes} checked by tsc
 */
var Angulartics2Module = /** @class */ (function () {
    function Angulartics2Module() {
    }
    /**
     * @param {?} providers
     * @param {?=} settings
     * @return {?}
     */
    Angulartics2Module.forRoot = /**
     * @param {?} providers
     * @param {?=} settings
     * @return {?}
     */
    function (providers, settings) {
        if (settings === void 0) { settings = {}; }
        return {
            ngModule: Angulartics2Module,
            providers: __spread([
                { provide: ANGULARTICS2_TOKEN, useValue: { providers: providers, settings: settings } },
                Angulartics2,
                { provide: RouterlessTracking, useClass: AngularRouterTracking }
            ], providers),
        };
    };
    Angulartics2Module.decorators = [
        { type: NgModule, args: [{
                    imports: [Angulartics2OnModule],
                    exports: [Angulartics2On],
                },] }
    ];
    return Angulartics2Module;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes} checked by tsc
 */

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes} checked by tsc
 */

export { Angulartics2, Angulartics2Module, ANGULARTICS2_TOKEN, Angulartics2On, Angulartics2OnModule, RouterlessTracking, AngularRouterTracking, DefaultConfig };

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYW5ndWxhcnRpY3MyLmpzLm1hcCIsInNvdXJjZXMiOlsibmc6Ly9hbmd1bGFydGljczIvYW5ndWxhcnRpY3MyLWNvbmZpZy50cyIsIm5nOi8vYW5ndWxhcnRpY3MyL2FuZ3VsYXJ0aWNzMi10b2tlbi50cyIsIm5nOi8vYW5ndWxhcnRpY3MyL3JvdXRlcmxlc3MudHMiLCJuZzovL2FuZ3VsYXJ0aWNzMi9hbmd1bGFydGljczItY29yZS50cyIsIm5nOi8vYW5ndWxhcnRpY3MyL2FuZ3VsYXItcm91dGVyLnRzIiwibmc6Ly9hbmd1bGFydGljczIvYW5ndWxhcnRpY3MyT24udHMiLCJuZzovL2FuZ3VsYXJ0aWNzMi9hbmd1bGFydGljczIubW9kdWxlLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBpbnRlcmZhY2UgR29vZ2xlQW5hbHl0aWNzU2V0dGluZ3Mge1xuICAvKiogYXJyYXkgb2YgYWRkaXRpb25hbCBhY2NvdW50IG5hbWVzIChvbmx5IHdvcmtzIGZvciBhbmFseXRpY3NqcykgKi9cbiAgYWRkaXRpb25hbEFjY291bnROYW1lczogc3RyaW5nW107XG4gIHVzZXJJZDogYW55O1xuICAvKiogc2VlIGh0dHBzOi8vZGV2ZWxvcGVycy5nb29nbGUuY29tL2FuYWx5dGljcy9kZXZndWlkZXMvY29sbGVjdGlvbi9hbmFseXRpY3Nqcy9maWVsZC1yZWZlcmVuY2UjdHJhbnNwb3J0ICovXG4gIHRyYW5zcG9ydDogc3RyaW5nO1xuICBhbm9ueW1pemVJcDogYm9vbGVhbjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBBcHBJbnNpZ2h0c1NldHRpbmdzIHtcbiAgdXNlcklkOiBzdHJpbmc7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgR29vZ2xlVGFnTWFuYWdlclNldHRpbmdzIHtcbiAgdXNlcklkOiBhbnk7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgUGFnZVRyYWNraW5nU2V0dGluZ3Mge1xuICBhdXRvVHJhY2tWaXJ0dWFsUGFnZXM6IGJvb2xlYW47XG4gIGJhc2VQYXRoOiBzdHJpbmc7XG4gIGV4Y2x1ZGVkUm91dGVzOiAoc3RyaW5nIHwgUmVnRXhwKVtdO1xuICAvKiogZHJvcCBpZHMgZnJvbSB1cmwgYC9zZWN0aW9ucy8xMjMvcGFnZXMvNDU2YCAtPiBgL3NlY3Rpb25zL3BhZ2VzYCAqL1xuICBjbGVhcklkczogYm9vbGVhbjtcbiAgLyoqIGRyb3AgY29udGVudHMgb2YgdXJsIGFmdGVyIGhhc2ggbWFya2VyIGAvY2FsbGJhY2sjYXV0aGNvZGU9MTIzNGAgLT4gYC9jYWxsYmFja2AgKi9cbiAgY2xlYXJIYXNoOiBib29sZWFuO1xuICAvKiogZHJvcCBxdWVyeSBwYXJhbXMgZnJvbSB1cmwgYC9zZWN0aW9ucy8xMjMvcGFnZXM/cGFyYW09NDU2JnBhcmFtMj03ODlgIC0+IGAvc2VjdGlvbnMvMTIzL3BhZ2VzYCAqL1xuICBjbGVhclF1ZXJ5UGFyYW1zOiBib29sZWFuO1xuICAvKiogdXNlZCB3aXRoIGNsZWFySWRzLCBkZWZpbmUgdGhlIG1hdGNoZXIgdG8gY2xlYXIgdXJsIHBhcnRzICovXG4gIGlkc1JlZ0V4cDogUmVnRXhwO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIEFuZ3VsYXJ0aWNzMlNldHRpbmdzIHtcbiAgcGFnZVRyYWNraW5nOiBQYXJ0aWFsPFBhZ2VUcmFja2luZ1NldHRpbmdzPjtcbiAgLyoqIERpc2FibGUgcGFnZSB0cmFja2luZyAqL1xuICBkZXZlbG9wZXJNb2RlOiBib29sZWFuO1xuICBnYTogUGFydGlhbDxHb29nbGVBbmFseXRpY3NTZXR0aW5ncz47XG4gIGFwcEluc2lnaHRzOiBQYXJ0aWFsPEFwcEluc2lnaHRzU2V0dGluZ3M+O1xuICBndG06IFBhcnRpYWw8R29vZ2xlVGFnTWFuYWdlclNldHRpbmdzPjtcbn1cblxuZXhwb3J0IGNsYXNzIERlZmF1bHRDb25maWcgaW1wbGVtZW50cyBBbmd1bGFydGljczJTZXR0aW5ncyB7XG4gIHBhZ2VUcmFja2luZyA9IHtcbiAgICBhdXRvVHJhY2tWaXJ0dWFsUGFnZXM6IHRydWUsXG4gICAgYmFzZVBhdGg6ICcnLFxuICAgIGV4Y2x1ZGVkUm91dGVzOiBbXSxcbiAgICBjbGVhcklkczogZmFsc2UsXG4gICAgY2xlYXJIYXNoOiBmYWxzZSxcbiAgICBjbGVhclF1ZXJ5UGFyYW1zOiBmYWxzZSxcbiAgICBpZHNSZWdFeHA6IC9eXFxkKyR8XlswLTlhLWZBLUZdezh9LVswLTlhLWZBLUZdezR9LVswLTlhLWZBLUZdezR9LVswLTlhLWZBLUZdezR9LVswLTlhLWZBLUZdezEyfSQvLFxuICB9O1xuICBkZXZlbG9wZXJNb2RlID0gZmFsc2U7XG4gIGdhID0ge307XG4gIGFwcEluc2lnaHRzID0ge307XG4gIGd0bSA9IHt9O1xufVxuIiwiaW1wb3J0IHsgSW5qZWN0aW9uVG9rZW4sIFByb3ZpZGVyIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5cbmltcG9ydCB7IEFuZ3VsYXJ0aWNzMlNldHRpbmdzIH0gZnJvbSAnLi9hbmd1bGFydGljczItY29uZmlnJztcblxuZXhwb3J0IGludGVyZmFjZSBBbmd1bGFydGljczJUb2tlbiB7XG4gIHByb3ZpZGVyczogUHJvdmlkZXJbXTtcbiAgc2V0dGluZ3M6IFBhcnRpYWw8QW5ndWxhcnRpY3MyU2V0dGluZ3M+O1xufVxuXG5leHBvcnQgY29uc3QgQU5HVUxBUlRJQ1MyX1RPS0VOID0gbmV3IEluamVjdGlvblRva2VuPEFuZ3VsYXJ0aWNzMlRva2VuPignQU5HVUxBUlRJQ1MyJyk7XG4iLCJpbXBvcnQgeyBCZWhhdmlvclN1YmplY3QsICBPYnNlcnZhYmxlIH0gZnJvbSAncnhqcyc7XG5cbmltcG9ydCB7IEFuZ3VsYXJ0aWNzMlNldHRpbmdzIH0gZnJvbSAnLi9hbmd1bGFydGljczItY29uZmlnJztcblxuZXhwb3J0IGludGVyZmFjZSBUcmFja05hdmlnYXRpb25FbmQge1xuICB1cmw6IHN0cmluZztcbn1cblxuZXhwb3J0IGNsYXNzIFJvdXRlcmxlc3NUcmFja2luZyB7XG4gIHRyYWNrTG9jYXRpb24oc2V0dGluZ3M6IEFuZ3VsYXJ0aWNzMlNldHRpbmdzKTogT2JzZXJ2YWJsZTxUcmFja05hdmlnYXRpb25FbmQ+IHtcbiAgICByZXR1cm4gbmV3IEJlaGF2aW9yU3ViamVjdDxUcmFja05hdmlnYXRpb25FbmQ+KHsgdXJsOiAnLycgfSk7XG4gIH1cbiAgcHJlcGFyZUV4dGVybmFsVXJsKHVybDogc3RyaW5nKTogc3RyaW5nIHtcbiAgICByZXR1cm4gdXJsO1xuICB9XG59XG4iLCJpbXBvcnQgeyBJbmplY3QsIEluamVjdGFibGUgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcblxuaW1wb3J0IHsgTW9ub1R5cGVPcGVyYXRvckZ1bmN0aW9uLCBSZXBsYXlTdWJqZWN0IH0gZnJvbSAncnhqcyc7XG5pbXBvcnQgeyBmaWx0ZXIgfSBmcm9tICdyeGpzL29wZXJhdG9ycyc7XG5cbmltcG9ydCB7IEFuZ3VsYXJ0aWNzMlNldHRpbmdzLCBEZWZhdWx0Q29uZmlnIH0gZnJvbSAnLi9hbmd1bGFydGljczItY29uZmlnJztcbmltcG9ydCB7IEV2ZW50VHJhY2ssIFBhZ2VUcmFjaywgVXNlclRpbWluZ3MgfSBmcm9tICcuL2FuZ3VsYXJ0aWNzMi1pbnRlcmZhY2VzJztcbmltcG9ydCB7IEFuZ3VsYXJ0aWNzMlRva2VuLCBBTkdVTEFSVElDUzJfVE9LRU4gfSBmcm9tICcuL2FuZ3VsYXJ0aWNzMi10b2tlbic7XG5pbXBvcnQgeyBSb3V0ZXJsZXNzVHJhY2tpbmcsIFRyYWNrTmF2aWdhdGlvbkVuZCB9IGZyb20gJy4vcm91dGVybGVzcyc7XG5cbkBJbmplY3RhYmxlKClcbmV4cG9ydCBjbGFzcyBBbmd1bGFydGljczIge1xuICBzZXR0aW5nczogQW5ndWxhcnRpY3MyU2V0dGluZ3M7XG5cbiAgcGFnZVRyYWNrID0gbmV3IFJlcGxheVN1YmplY3Q8UGFydGlhbDxQYWdlVHJhY2s+PigxMCk7XG4gIGV2ZW50VHJhY2sgPSBuZXcgUmVwbGF5U3ViamVjdDxQYXJ0aWFsPEV2ZW50VHJhY2s+PigxMCk7XG4gIGV4Y2VwdGlvblRyYWNrID0gbmV3IFJlcGxheVN1YmplY3Q8YW55PigxMCk7XG4gIHNldEFsaWFzID0gbmV3IFJlcGxheVN1YmplY3Q8c3RyaW5nPigxMCk7XG4gIHNldFVzZXJuYW1lID0gbmV3IFJlcGxheVN1YmplY3Q8eyB1c2VySWQ6IHN0cmluZyB8IG51bWJlciB9IHwgc3RyaW5nPigxMCk7XG4gIHNldFVzZXJQcm9wZXJ0aWVzID0gbmV3IFJlcGxheVN1YmplY3Q8YW55PigxMCk7XG4gIHNldFVzZXJQcm9wZXJ0aWVzT25jZSA9IG5ldyBSZXBsYXlTdWJqZWN0PGFueT4oMTApO1xuICBzZXRTdXBlclByb3BlcnRpZXMgPSBuZXcgUmVwbGF5U3ViamVjdDxhbnk+KDEwKTtcbiAgc2V0U3VwZXJQcm9wZXJ0aWVzT25jZSA9IG5ldyBSZXBsYXlTdWJqZWN0PGFueT4oMTApO1xuICB1c2VyVGltaW5ncyA9IG5ldyBSZXBsYXlTdWJqZWN0PFVzZXJUaW1pbmdzPigxMCk7XG5cbiAgY29uc3RydWN0b3IoXG4gICAgcHJpdmF0ZSB0cmFja2VyOiBSb3V0ZXJsZXNzVHJhY2tpbmcsXG4gICAgQEluamVjdChBTkdVTEFSVElDUzJfVE9LRU4pIHNldHVwOiBBbmd1bGFydGljczJUb2tlbixcbiAgKSB7XG4gICAgY29uc3QgZGVmYXVsdENvbmZpZyA9IG5ldyBEZWZhdWx0Q29uZmlnKCk7XG4gICAgdGhpcy5zZXR0aW5ncyA9IHsgLi4uZGVmYXVsdENvbmZpZywgLi4uc2V0dXAuc2V0dGluZ3MgfTtcbiAgICB0aGlzLnNldHRpbmdzLnBhZ2VUcmFja2luZyA9IHtcbiAgICAgIC4uLmRlZmF1bHRDb25maWcucGFnZVRyYWNraW5nLFxuICAgICAgLi4uc2V0dXAuc2V0dGluZ3MucGFnZVRyYWNraW5nLFxuICAgIH07XG4gICAgdGhpcy50cmFja2VyXG4gICAgICAudHJhY2tMb2NhdGlvbih0aGlzLnNldHRpbmdzKVxuICAgICAgLnN1YnNjcmliZSgoZXZlbnQ6IFRyYWNrTmF2aWdhdGlvbkVuZCkgPT5cbiAgICAgICAgdGhpcy50cmFja1VybENoYW5nZShldmVudC51cmwpLFxuICAgICAgKTtcbiAgfVxuXG4gIC8qKiBmaWx0ZXJzIGFsbCBldmVudHMgd2hlbiBkZXZlbG9wZXIgbW9kZSBpcyB0cnVlICovXG4gIGZpbHRlckRldmVsb3Blck1vZGU8VD4oKTogTW9ub1R5cGVPcGVyYXRvckZ1bmN0aW9uPFQ+IHtcbiAgICByZXR1cm4gZmlsdGVyKCh2YWx1ZSwgaW5kZXgpID0+ICF0aGlzLnNldHRpbmdzLmRldmVsb3Blck1vZGUpO1xuICB9XG5cbiAgcHJvdGVjdGVkIHRyYWNrVXJsQ2hhbmdlKHVybDogc3RyaW5nKSB7XG4gICAgaWYgKHRoaXMuc2V0dGluZ3MucGFnZVRyYWNraW5nLmF1dG9UcmFja1ZpcnR1YWxQYWdlcyAmJiAhdGhpcy5tYXRjaGVzRXhjbHVkZWRSb3V0ZSh1cmwpKSB7XG4gICAgICBjb25zdCBjbGVhcmVkVXJsID0gdGhpcy5jbGVhclVybCh1cmwpO1xuICAgICAgbGV0IHBhdGg6IHN0cmluZztcbiAgICAgIGlmICh0aGlzLnNldHRpbmdzLnBhZ2VUcmFja2luZy5iYXNlUGF0aC5sZW5ndGgpIHtcbiAgICAgICAgcGF0aCA9IHRoaXMuc2V0dGluZ3MucGFnZVRyYWNraW5nLmJhc2VQYXRoICsgY2xlYXJlZFVybDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHBhdGggPSB0aGlzLnRyYWNrZXIucHJlcGFyZUV4dGVybmFsVXJsKGNsZWFyZWRVcmwpO1xuICAgICAgfVxuICAgICAgdGhpcy5wYWdlVHJhY2submV4dCh7IHBhdGggfSk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFVzZSBzdHJpbmcgbGl0ZXJhbHMgb3IgcmVndWxhciBleHByZXNzaW9ucyB0byBleGNsdWRlIHJvdXRlc1xuICAgKiBmcm9tIGF1dG9tYXRpYyBwYWdldmlldyB0cmFja2luZy5cbiAgICpcbiAgICogQHBhcmFtIHVybCBsb2NhdGlvblxuICAgKi9cbiAgcHJvdGVjdGVkIG1hdGNoZXNFeGNsdWRlZFJvdXRlKHVybDogc3RyaW5nKTogYm9vbGVhbiB7XG4gICAgZm9yIChjb25zdCBleGNsdWRlZFJvdXRlIG9mIHRoaXMuc2V0dGluZ3MucGFnZVRyYWNraW5nLmV4Y2x1ZGVkUm91dGVzKSB7XG4gICAgICBjb25zdCBtYXRjaGVzUmVnZXggPSBleGNsdWRlZFJvdXRlIGluc3RhbmNlb2YgUmVnRXhwICYmIGV4Y2x1ZGVkUm91dGUudGVzdCh1cmwpO1xuICAgICAgaWYgKG1hdGNoZXNSZWdleCB8fCB1cmwuaW5kZXhPZig8c3RyaW5nPmV4Y2x1ZGVkUm91dGUpICE9PSAtMSkge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgLyoqXG4gICAqIFJlbW92ZXMgaWQncyBmcm9tIHRyYWNrZWQgcm91dGUuXG4gICAqICBFWDogYC9wcm9qZWN0LzEyOTgxL2ZlYXR1cmVgIGJlY29tZXMgYC9wcm9qZWN0L2ZlYXR1cmVgXG4gICAqXG4gICAqIEBwYXJhbSB1cmwgY3VycmVudCBwYWdlIHBhdGhcbiAgICovXG4gIHByb3RlY3RlZCBjbGVhclVybCh1cmw6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgaWYgKHRoaXMuc2V0dGluZ3MucGFnZVRyYWNraW5nLmNsZWFySWRzIHx8IHRoaXMuc2V0dGluZ3MucGFnZVRyYWNraW5nLmNsZWFyUXVlcnlQYXJhbXMgfHxcbiAgICAgIHRoaXMuc2V0dGluZ3MucGFnZVRyYWNraW5nLmNsZWFySGFzaCkge1xuICAgICAgcmV0dXJuIHVybFxuICAgICAgICAuc3BsaXQoJy8nKVxuICAgICAgICAubWFwKHBhcnQgPT4gdGhpcy5zZXR0aW5ncy5wYWdlVHJhY2tpbmcuY2xlYXJRdWVyeVBhcmFtcyA/IHBhcnQuc3BsaXQoJz8nKVswXSA6IHBhcnQpXG4gICAgICAgIC5tYXAocGFydCA9PiB0aGlzLnNldHRpbmdzLnBhZ2VUcmFja2luZy5jbGVhckhhc2ggPyBwYXJ0LnNwbGl0KCcjJylbMF0gOiBwYXJ0KVxuICAgICAgICAuZmlsdGVyKHBhcnQgPT4gIXRoaXMuc2V0dGluZ3MucGFnZVRyYWNraW5nLmNsZWFySWRzIHx8ICFwYXJ0Lm1hdGNoKHRoaXMuc2V0dGluZ3MucGFnZVRyYWNraW5nLmlkc1JlZ0V4cCkpXG4gICAgICAgIC5qb2luKCcvJyk7XG4gICAgfVxuICAgIHJldHVybiB1cmw7XG4gIH1cbn1cbiIsImltcG9ydCB7IExvY2F0aW9uIH0gZnJvbSAnQGFuZ3VsYXIvY29tbW9uJztcbmltcG9ydCB7IEluamVjdGFibGUgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IE5hdmlnYXRpb25FbmQsIFJvdXRlciB9IGZyb20gJ0Bhbmd1bGFyL3JvdXRlcic7XG5cbmltcG9ydCB7IGRlbGF5LCBmaWx0ZXIsIG1hcCB9IGZyb20gJ3J4anMvb3BlcmF0b3JzJztcblxuaW1wb3J0IHsgT2JzZXJ2YWJsZSB9IGZyb20gJ3J4anMnO1xuaW1wb3J0IHsgUm91dGVybGVzc1RyYWNraW5nLCBUcmFja05hdmlnYXRpb25FbmQgfSBmcm9tICcuL3JvdXRlcmxlc3MnO1xuXG4vKipcbiAqIFRyYWNrIFJvdXRlIGNoYW5nZXMgZm9yIGFwcGxpY2F0aW9ucyB1c2luZyBBbmd1bGFyJ3NcbiAqIGRlZmF1bHQgcm91dGVyXG4gKlxuICogQGxpbmsgaHR0cHM6Ly9hbmd1bGFyLmlvL2FwaS9yb3V0ZXIvUm91dGVyXG4gKi9cbkBJbmplY3RhYmxlKClcbmV4cG9ydCBjbGFzcyBBbmd1bGFyUm91dGVyVHJhY2tpbmcgaW1wbGVtZW50cyBSb3V0ZXJsZXNzVHJhY2tpbmcge1xuICBjb25zdHJ1Y3RvcihcbiAgICBwcml2YXRlIHJvdXRlcjogUm91dGVyLFxuICAgIHByaXZhdGUgbG9jYXRpb246IExvY2F0aW9uLFxuICApIHt9XG5cbiAgdHJhY2tMb2NhdGlvbihzZXR0aW5ncyk6IE9ic2VydmFibGU8VHJhY2tOYXZpZ2F0aW9uRW5kPiB7XG4gICAgcmV0dXJuIHRoaXMucm91dGVyLmV2ZW50cy5waXBlKFxuICAgICAgZmlsdGVyKGUgPT4gZSBpbnN0YW5jZW9mIE5hdmlnYXRpb25FbmQpLFxuICAgICAgZmlsdGVyKCgpID0+ICFzZXR0aW5ncy5kZXZlbG9wZXJNb2RlKSxcbiAgICAgIG1hcCgoZTogTmF2aWdhdGlvbkVuZCkgPT4ge1xuICAgICAgICByZXR1cm4geyB1cmw6IGUudXJsQWZ0ZXJSZWRpcmVjdHMgfTtcbiAgICAgIH0pLFxuICAgICAgZGVsYXkoMCksXG4gICAgKTtcbiAgfVxuXG4gIHByZXBhcmVFeHRlcm5hbFVybCh1cmw6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgcmV0dXJuIHRoaXMubG9jYXRpb24ucHJlcGFyZUV4dGVybmFsVXJsKHVybCk7XG4gIH1cbn1cbiIsImltcG9ydCB7XG4gIEFmdGVyQ29udGVudEluaXQsXG4gIERpcmVjdGl2ZSxcbiAgRWxlbWVudFJlZixcbiAgSW5qZWN0YWJsZSxcbiAgSW5wdXQsXG4gIE5nTW9kdWxlLFxuICBSZW5kZXJlcjIsXG59IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgQW5ndWxhcnRpY3MyIH0gZnJvbSAnLi9hbmd1bGFydGljczItY29yZSc7XG5cbkBJbmplY3RhYmxlKClcbkBEaXJlY3RpdmUoeyBzZWxlY3RvcjogJ1thbmd1bGFydGljczJPbl0nIH0pXG5leHBvcnQgY2xhc3MgQW5ndWxhcnRpY3MyT24gaW1wbGVtZW50cyBBZnRlckNvbnRlbnRJbml0IHtcbiAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOm5vLWlucHV0LXJlbmFtZVxuICBASW5wdXQoJ2FuZ3VsYXJ0aWNzMk9uJykgYW5ndWxhcnRpY3MyT246IHN0cmluZztcbiAgQElucHV0KCkgYW5ndWxhcnRpY3NBY3Rpb246IHN0cmluZztcbiAgQElucHV0KCkgYW5ndWxhcnRpY3NDYXRlZ29yeTogc3RyaW5nO1xuICBASW5wdXQoKSBhbmd1bGFydGljc0xhYmVsOiBzdHJpbmc7XG4gIEBJbnB1dCgpIGFuZ3VsYXJ0aWNzVmFsdWU6IHN0cmluZztcbiAgQElucHV0KCkgYW5ndWxhcnRpY3NQcm9wZXJ0aWVzOiBhbnkgPSB7fTtcblxuICBjb25zdHJ1Y3RvcihcbiAgICBwcml2YXRlIGVsUmVmOiBFbGVtZW50UmVmLFxuICAgIHByaXZhdGUgYW5ndWxhcnRpY3MyOiBBbmd1bGFydGljczIsXG4gICAgcHJpdmF0ZSByZW5kZXJlcjogUmVuZGVyZXIyXG4gICkgeyB9XG5cbiAgbmdBZnRlckNvbnRlbnRJbml0KCkge1xuICAgIHRoaXMucmVuZGVyZXIubGlzdGVuKFxuICAgICAgdGhpcy5lbFJlZi5uYXRpdmVFbGVtZW50LFxuICAgICAgdGhpcy5hbmd1bGFydGljczJPbiB8fCAnY2xpY2snLFxuICAgICAgKGV2ZW50OiBFdmVudCkgPT4gdGhpcy5ldmVudFRyYWNrKGV2ZW50KSxcbiAgICApO1xuICB9XG5cbiAgZXZlbnRUcmFjayhldmVudDogRXZlbnQpIHtcbiAgICBjb25zdCBhY3Rpb24gPSB0aGlzLmFuZ3VsYXJ0aWNzQWN0aW9uOyAvLyB8fCB0aGlzLmluZmVyRXZlbnROYW1lKCk7XG4gICAgY29uc3QgcHJvcGVydGllczogYW55ID0ge1xuICAgICAgLi4udGhpcy5hbmd1bGFydGljc1Byb3BlcnRpZXMsXG4gICAgICBldmVudFR5cGU6IGV2ZW50LnR5cGUsXG4gICAgfTtcblxuICAgIGlmICh0aGlzLmFuZ3VsYXJ0aWNzQ2F0ZWdvcnkpIHtcbiAgICAgIHByb3BlcnRpZXMuY2F0ZWdvcnkgPSB0aGlzLmFuZ3VsYXJ0aWNzQ2F0ZWdvcnk7XG4gICAgfVxuICAgIGlmICh0aGlzLmFuZ3VsYXJ0aWNzTGFiZWwpIHtcbiAgICAgIHByb3BlcnRpZXMubGFiZWwgPSB0aGlzLmFuZ3VsYXJ0aWNzTGFiZWw7XG4gICAgfVxuICAgIGlmICh0aGlzLmFuZ3VsYXJ0aWNzVmFsdWUpIHtcbiAgICAgIHByb3BlcnRpZXMudmFsdWUgPSB0aGlzLmFuZ3VsYXJ0aWNzVmFsdWU7XG4gICAgfVxuXG4gICAgdGhpcy5hbmd1bGFydGljczIuZXZlbnRUcmFjay5uZXh0KHtcbiAgICAgIGFjdGlvbixcbiAgICAgIHByb3BlcnRpZXMsXG4gICAgfSk7XG4gIH1cblxuICAvKnByaXZhdGUgaXNDb21tYW5kKCkge1xuICAgIHJldHVybiBbJ2E6JywgJ2J1dHRvbjonLCAnYnV0dG9uOmJ1dHRvbicsICdidXR0b246c3VibWl0JywgJ2lucHV0OmJ1dHRvbicsICdpbnB1dDpzdWJtaXQnXS5pbmRleE9mKFxuICAgICAgZ2V0RE9NKCkudGFnTmFtZSh0aGlzLmVsKS50b0xvd2VyQ2FzZSgpICsgJzonICsgKGdldERPTSgpLnR5cGUodGhpcy5lbCkgfHwgJycpKSA+PSAwO1xuICB9XG5cbiAgcHJpdmF0ZSBpbmZlckV2ZW50TmFtZSgpIHtcbiAgICBpZiAodGhpcy5pc0NvbW1hbmQoKSkgcmV0dXJuIGdldERPTSgpLmdldFRleHQodGhpcy5lbCkgfHwgZ2V0RE9NKCkuZ2V0VmFsdWUodGhpcy5lbCk7XG4gICAgcmV0dXJuIGdldERPTSgpLmdldFByb3BlcnR5KHRoaXMuZWwsICdpZCcpIHx8IGdldERPTSgpLmdldFByb3BlcnR5KHRoaXMuZWwsICduYW1lJykgfHwgZ2V0RE9NKCkudGFnTmFtZSh0aGlzLmVsKTtcbiAgfSovXG59XG5cbkBOZ01vZHVsZSh7XG4gIGRlY2xhcmF0aW9uczogW0FuZ3VsYXJ0aWNzMk9uXSxcbiAgZXhwb3J0czogW0FuZ3VsYXJ0aWNzMk9uXSxcbn0pXG5leHBvcnQgY2xhc3MgQW5ndWxhcnRpY3MyT25Nb2R1bGUge31cbiIsImltcG9ydCB7XG4gIE1vZHVsZVdpdGhQcm92aWRlcnMsXG4gIE5nTW9kdWxlLFxuICBQcm92aWRlcixcbn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5cbmltcG9ydCB7IEFuZ3VsYXJSb3V0ZXJUcmFja2luZyB9IGZyb20gJy4vYW5ndWxhci1yb3V0ZXInO1xuaW1wb3J0IHsgQW5ndWxhcnRpY3MyU2V0dGluZ3MgfSBmcm9tICcuL2FuZ3VsYXJ0aWNzMi1jb25maWcnO1xuaW1wb3J0IHsgQW5ndWxhcnRpY3MyIH0gZnJvbSAnLi9hbmd1bGFydGljczItY29yZSc7XG5pbXBvcnQgeyBBTkdVTEFSVElDUzJfVE9LRU4gfSBmcm9tICcuL2FuZ3VsYXJ0aWNzMi10b2tlbic7XG5pbXBvcnQgeyBBbmd1bGFydGljczJPbiwgQW5ndWxhcnRpY3MyT25Nb2R1bGUgfSBmcm9tICcuL2FuZ3VsYXJ0aWNzMk9uJztcbmltcG9ydCB7IFJvdXRlcmxlc3NUcmFja2luZyB9IGZyb20gJy4vcm91dGVybGVzcyc7XG5cblxuQE5nTW9kdWxlKHtcbiAgaW1wb3J0czogW0FuZ3VsYXJ0aWNzMk9uTW9kdWxlXSxcbiAgZXhwb3J0czogW0FuZ3VsYXJ0aWNzMk9uXSxcbn0pXG5leHBvcnQgY2xhc3MgQW5ndWxhcnRpY3MyTW9kdWxlIHtcbiAgc3RhdGljIGZvclJvb3QoXG4gICAgcHJvdmlkZXJzOiBQcm92aWRlcltdLFxuICAgIHNldHRpbmdzOiBQYXJ0aWFsPEFuZ3VsYXJ0aWNzMlNldHRpbmdzPiA9IHt9LFxuICApOiBNb2R1bGVXaXRoUHJvdmlkZXJzIHtcbiAgICByZXR1cm4ge1xuICAgICAgbmdNb2R1bGU6IEFuZ3VsYXJ0aWNzMk1vZHVsZSxcbiAgICAgIHByb3ZpZGVyczogW1xuICAgICAgICB7IHByb3ZpZGU6IEFOR1VMQVJUSUNTMl9UT0tFTiwgdXNlVmFsdWU6IHsgcHJvdmlkZXJzLCBzZXR0aW5ncyB9IH0sXG4gICAgICAgIEFuZ3VsYXJ0aWNzMixcbiAgICAgICAgeyBwcm92aWRlOiBSb3V0ZXJsZXNzVHJhY2tpbmcsIHVzZUNsYXNzOiBBbmd1bGFyUm91dGVyVHJhY2tpbmcgfSxcbiAgICAgICAgLi4ucHJvdmlkZXJzLFxuICAgICAgXSxcbiAgICB9O1xuICB9XG59XG4iXSwibmFtZXMiOlsidHNsaWJfMS5fX3ZhbHVlcyJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7SUF3Q0E7OzRCQUNpQjtZQUNiLHFCQUFxQixFQUFFLElBQUk7WUFDM0IsUUFBUSxFQUFFLEVBQUU7WUFDWixjQUFjLEVBQUUsRUFBRTtZQUNsQixRQUFRLEVBQUUsS0FBSztZQUNmLFNBQVMsRUFBRSxLQUFLO1lBQ2hCLGdCQUFnQixFQUFFLEtBQUs7WUFDdkIsU0FBUyxFQUFFLHFG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